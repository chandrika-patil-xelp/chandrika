<!DOCTYPE html>
<html>
<head>
  <title>Invoice</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="<?php echo DOMAIN ?>frontend/tools/css/inc.css">
  <!-- <link href="../css/main.css" rel="stylesheet" type="text/css"/> -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.debug.js"></script>
  <script src="<?php echo DOMAIN ?>frontend/tools/js/jquery.js" type="text/javascript"></script>
  <script src="<?php echo DOMAIN ?>frontend/tools/js/html2canvas.js" type="text/javascript"></script>
  <script src="<?php echo DOMAIN ?>frontend/tools/js/jQuery.print.js" type="text/javascript"></script>
</head>
<body>
  <div class="containers CUSINV fLeft">
     <div class="InvGen" id="toconvert">
       <div class="invInr fLeft">
          <div class="addDtls fLeft">
          	<div class="col50 fLeft">
          		<div class="comLogo fLeft">

          		</div>
          	</div>
          	<div class="col50 fLeft">
          		<div class="comAddrs fLeft">
          			JZEVA SIGNATURE JEWELCRAFT PVT. LTD.
          		</div>
          		<div class="homAddrs fLeft">
          		   <div class="addrs fLeft">
                            S3 Prabhu Kunj, 2nd Main, Rdeshwara Layout,
                       </div>
                       <div class="addrs fLeft">
                            Opp.City West Club, Indiranagar 2nd Stage,
                       </div>
                       <div class="addrs fLeft">
                            Bangalore â€“ 560038
                       </div>
          		</div>
          	</div>
          </div>
          <div class="col100 fLeft poR">
           <center>
          	 <div class="clInc btmInc">
          	 	INVOICE
          	 </div>
          	 </center>
          </div>
          <div class="col100 fLeft">
          	<div class="col50 fLeft">
          		<div class="blngSeq fLeft">
          			BILLING ADDRESS
          		</div>
          		<div class="prsnDtl fLeft" id="cust_name">
          			 
          		</div>
          		<div class="blwDtl fLeft">
          		<div class="prslAdrs fLeft"  id="cust_addrs">
          			Tappovan Terraces,
          		</div>
          		<div class="prsloc fLeft" id="cust_city">
          			JP Nagar,
          		</div>
          		<div class="prsCty fLeft" id="cust_state">
          			Mysore.
          		</div>
          		</div>
          	</div>
          	<div class="col50 fLeft">
                    <div class="inVoc fLeft">
                        <div class="invocNo fLeft" id="invoice_no">
                            INVOICE NO - 
                       </div>
                       <div class="delDate fLeft">
                            DATE - 02-01-2017
                       </div>
                  </div>
             </div>
          </div>
          <div class="col100 fLeft">
               <div class="snoPrd fLeft">
                    Sr No.
               </div>
               <div class="dtlPrd fLeft">
                    Product Details
               </div>
                <div class="qtDesp fLeft">
                  Quantity
               </div>
               <div class="prcVal cartRup15b fLeft">
                  Price 
               </div>
               <div class="amGen cartRup15b fLeft">
                  Amount  
               </div>
          </div>
          <div class="col100 fLeft" id="orderslist">
<!--          <div class="cols100 margn fLeft">
           <div class="srLst alng fLeft">
               1
          </div>
           <div class="prodBuy fLeft">
               <div class="prodDesc fLeft">
                    Ring
               </div>
               <div class="itmDtl algnGen fLeft">
                    Product Code: JZEVA 2343423534
               </div>
                <div class="itmDtl algnGen fLeft">
                    Gold:18K, 2.50 Grm
               </div>
                <div class="itmDtl algnGen fLeft">
                    Diamond: 0.25 Ct, SI-1J
               </div>
          </div>
          <div class="qutVal alng fLeft">
               1
          </div>
          <div class="prcCost alng fLeft">
               18,710.00
          </div>
          <div class="amtCost alng fLeft">
               18,710.00
          </div>
        </div>-->
<!--         <div class="cols100 margn fLeft">
           <div class="srLst alng fLeft">
               2

          </div>
           <div class="prodBuy fLeft">
               <div class="prodDesc fLeft">
                    Earring
               </div>
               <div class="itmDtl algnGen fLeft">
                    Product Code: JZEVA 2343423534
               </div>
                <div class="itmDtl algnGen fLeft">
                    Gold:18K, 2.50 Grm
               </div>
                <div class="itmDtl algnGen fLeft">
                    Diamond: 0.25 Ct, SI-1J
               </div>
          </div>
          <div class="qutVal alng fLeft">
               1
          </div>
          <div class="prcCost alng fLeft">
               18,710.00
          </div>
          <div class="amtCost alng fLeft">
               18,710.00
          </div>
        </div>-->
<!--        <div class="cols100 margn fLeft">
          <div class="srLst alng fLeft">
              2

         </div>
          <div class="prodBuy fLeft">
              <div class="prodDesc fLeft">
                   Earring
              </div>
              <div class="itmDtl algnGen fLeft">
                   Product Code: JZEVA 2343423534
              </div>
               <div class="itmDtl algnGen fLeft">
                   Gold:18K, 2.50 Grm
              </div>
               <div class="itmDtl algnGen fLeft">
                   Diamond: 0.25 Ct, SI-1J
              </div>
         </div>
         <div class="qutVal alng fLeft">
              1
         </div>
         <div class="prcCost alng fLeft">
              18,710.00
         </div>
         <div class="amtCost alng fLeft">
              18,710.00
         </div>
       </div>-->
<!--       <div class="cols100 margn fLeft">
         <div class="srLst alng fLeft">
             2

        </div>
         <div class="prodBuy fLeft">
             <div class="prodDesc fLeft">
                  Earring
             </div>
             <div class="itmDtl algnGen fLeft">
                  Product Code: JZEVA 2343423534
             </div>
              <div class="itmDtl algnGen fLeft">
                  Gold:18K, 2.50 Grm
             </div>
              <div class="itmDtl algnGen fLeft">
                  Diamond: 0.25 Ct, SI-1J
             </div>
        </div>
        <div class="qutVal alng fLeft">
             1
        </div>
        <div class="prcCost alng fLeft">
             18,710.00
        </div>
        <div class="amtCost alng fLeft">
             18,710.00
        </div>
      </div>-->
<!--      <div class="cols100 margn fLeft">
        <div class="srLst alng fLeft">
            2

       </div>
        <div class="prodBuy fLeft">
            <div class="prodDesc fLeft">
                 Earring
            </div>
            <div class="itmDtl algnGen fLeft">
                 Product Code: JZEVA 2343423534
            </div>
             <div class="itmDtl algnGen fLeft">
                 Gold:18K, 2.50 Grm
            </div>
             <div class="itmDtl algnGen fLeft">
                 Diamond: 0.25 Ct, SI-1J
            </div>
       </div>
       <div class="qutVal alng fLeft">
            1
       </div>
       <div class="prcCost alng fLeft">
            18,710.00
       </div>
       <div class="amtCost alng fLeft">
            18,710.00
       </div>
     </div>-->
        </div>
        <div class="col100 fLeft">
            <div class="prcTag fLeft">
                 Inclusive of all taxes
            </div>
            <div class="col50 fRight">
                 <div class="amtDc fLeft">
                      Total Amount
                 </div>
                 <div class="grndTs cartRup15b fRight" id="tot_amnt">
                      37,000.00
                 </div>
            </div>
        </div>
        <div class="col100 fLeft">
             <div class="wdAuto fLeft">
                  <div class="dePrsn fLeft">
                       <span id="thnk_name">Mrs. Sakshi Santoshi,</span> Thank you for choosing JZEVA.
                  </div>
                  <div class="col100 fLeft">
                       <div class="Regrd fLeft">
                            We are extremly happy to serve you.
                       </div>
                       <div class="Regrd fLeft">
                            If you need any further assistance regarding your order.
                       </div>
                       <div class="Regrd fLeft">
                            you can call us on +91 7022248207 or mail us at <a href=""><span>care@jzeva.com</span></a>
                       </div>
                       <div class="sale fLeft">
                            For more details on <span>Condiations Of Sale</span> and <span>Policies,</span> please visit <a href="">www.jzeva.com</a>
                       </div>
                  </div>
             </div>
        </div>
       </div>
       <div class="fotr fLeft">
             <div class="wtAt fLeft">
                  Visit us at <a href="<?php echo DOMAIN ?>index.php?action=landing_page"><span>www.jzeva.com</span></a>
             </div>
             <div class="wtAt fRight">
                VAT TIN NO: 29981380559
             </div>
        </div>
        <div class="addf fLeft dn" id="create_pdf">
          DOWNLOAD PDF
        </div>
     </div>
  </div>
   <script>var ordid="<?php echo $_GET['ordid'] ?>"</script>
  <script>
  var APIDOMAIN = '<?php echo APIDOMAIN?>';
            var element = $("#toconvert");
           $("#create_pdf").on('click', function () { //PDF Conversion
                 $('body').scrollTop(30);
                    html2canvas(element, {
                    onrendered: function (canvas) {
                           $('canvas').remove();
                           var imgData = canvas.toDataURL("image/jpeg");
                           var imgWidth = 210; //A4 Size
                           var pageHeight = 297;
                           var imgHeight = canvas.height * imgWidth / canvas.width;
                           var heightLeft = imgHeight;
                           var pdf = new jsPDF('p', 'mm','a4');
                           var position = 0;
                           pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
                             heightLeft -= pageHeight;

                            while (heightLeft >= 0) {
                              position = heightLeft - imgHeight;
                              pdf.addPage();
                              pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
                              heightLeft -= pageHeight;
                            }

                           var namefile = 'jzeva_invoice';
                           pdf.save(namefile + ".pdf");
                        }
                   });

           });
	   
  $(document).ready(function(){
     getOrderdetails();
     setTimeout(function(){
       $('#create_pdf').click();
       },200);
      setTimeout(function () { 
  	window.close(); 
      }, 2000);
  });
  
  
  function getOrderdetails()
  {
    var URL=APIDOMAIN + "index.php?action=OrderDetailsbyordid&orderid="+ordid;
    $.ajax({url:URL,type:'GET',datatype:'JSON',success:function(res){
	var data=JSON.parse(res);
	  
	var gndr=data['result'][0].gender,gndrstr;
	if(gndr == 1)
	  gndrstr="Ms.";
	else if(gndr == 2)
	  gndrstr="Mr.";
	else if(gndr == 3)
	  gndrstr="Mrs.";
	else
	  gndrstr="Dear";
	
	$('#cust_name').html(gndrstr+" "+data['result'][0].uname);
	$('#cust_addrs').html(data['result'][0].uaddres);
	$('#cust_city').html(data['result'][0].ucity);
	$('#cust_state').html(data['result'][0].ustate);
	$('#tot_amnt').html(data.totalprice);
	$('#thnk_name').html(data['result'][0].uname);
	$('#invoice_no').append(data['result'][0].invoiceno);
	
	var ords=data['result'], ordstr="",wht;
	
	$(ords).each(function(r,v){
	 
	  if (v.ccatname !== null) {
	      wht = getweight(v.size, v.ccatname, v.metal_weight);
	  } else {
	      wht = v.metal_weight;
	  }
	  
	  ordstr+='<div class="cols100 margn fLeft">';
	  ordstr+=' <div class="srLst alng fLeft">'+(r+1);
	  ordstr+='</div>';
	  ordstr+='<div class="prodBuy fLeft">';
	  ordstr+=' <div class="prodDesc fLeft">'+v.prd_name;
	  ordstr+='';
	  ordstr+='</div>';
	  ordstr+=' <div class="itmDtl algnGen fLeft">';
	  ordstr+='  Product Code: '+v.prd_code;
	  ordstr+=' </div>';
	  ordstr+=' <div class="itmDtl algnGen fLeft">';
	  ordstr+='  Gold: '+v.carat+', '+wht+' Grm';
	  if(parseInt(v.size) !== 0 )
	    ordstr+=', Size: '+v.size;
	  ordstr+=' </div> ';
	  ordstr+=' <div class="itmDtl algnGen fLeft">';
	  ordstr+='  Diamond: '+v.dmdcarat+' Ct, '+v.quality;
	  ordstr+='  </div>';
	  ordstr+='</div>  <div class="qutVal alng fLeft">'+v.pqty; 
	  ordstr+='</div>';
	  ordstr+='<div class="prcCost alng fLeft">'+parseInt(v.basic_prz); 
	  ordstr+='</div>';
	  ordstr+='<div class="amtCost alng fLeft">'+parseInt(v.ppri); 
	  ordstr+='</div>';
	  ordstr+='</div>';
	  
	});
	$('#orderslist').append(ordstr);
      }
    });
  }
     
  function getweight(currentSize, catName, storedWt)
  {
      var mtlWgDav = 0;
      var bseSize = 0;

      if (catName.toLowerCase() == 'rings') {
	  bseSize = parseFloat(14);
	  mtlWgDav = 0.05;
      } else if (catName.toLowerCase() == 'bangles') {
	  bseSize = parseFloat(2.4);
	  mtlWgDav = 7;
      }

     if (isNaN(currentSize))
      {

	  if (catName == 'Rings')
	      currentSize = parseFloat(14);
	  else if (catName == 'Bangles')
	      currentSize = parseFloat(2.4);
	  else if (catName !== 'Rings' && catName !== 'Bangles') {
	      currentSize = 0;
	  }
      }
 
      var changeInWeight = (currentSize - bseSize) * mtlWgDav;
      var newWeight = parseFloat(storedWt) + parseFloat(changeInWeight);
      newWeight=newWeight.toFixed(3); 
      return newWeight; 
  }
  
       </script>
</body>
</html>
